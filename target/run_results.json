{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-12-25T04:28:42.059576Z", "invocation_id": "657def3e-2287-48fe-9771-31e738b9212e", "invocation_started_at": "2025-12-25T04:28:28.506660Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-25T04:28:33.642576Z", "completed_at": "2025-12-25T04:28:33.650678Z"}, {"name": "execute", "started_at": "2025-12-25T04:28:33.651584Z", "completed_at": "2025-12-25T04:28:35.498485Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8582170009613037, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c1476c-3203-9366-0006-f3c200012a8e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.DBT_TEST_DEMO.cur_order_dist_by_mktseg", "compiled": true, "compiled_code": "WITH joindata AS (\n    SELECT\n        cust.c_custkey,\n        cust.c_mktsegment,\n        ordr.o_orderdate,\n        ordr.o_orderkey,\n        ordr.o_orderstatus,\n        ordr.o_totalprice\n    FROM dbt_test_demo.src.src_customers AS cust\n    INNER JOIN dbt_test_demo.src.src_orders AS ordr\n        ON cust.c_custkey = ordr.o_custkey\n),\n\naggr AS (\n    SELECT\n        joindata.c_mktsegment,\n        joindata.o_orderdate,\n        sum(joindata.o_totalprice) AS totalprice\n    FROM joindata\n    GROUP BY joindata.c_mktsegment, joindata.o_orderdate\n)\n\nSELECT * FROM aggr", "relation_name": "dbt_test_demo.curated.cur_order_dist_by_mktseg", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-25T04:28:35.506418Z", "completed_at": "2025-12-25T04:28:35.516570Z"}, {"name": "execute", "started_at": "2025-12-25T04:28:35.517689Z", "completed_at": "2025-12-25T04:28:38.591534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.0871548652648926, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c1476c-3203-9366-0006-f3c200012aaa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.DBT_TEST_DEMO.dim_part_new", "compiled": true, "compiled_code": "\n -- 1Type1 columns to update in variable \n-- 1\ufe0f\u20e3 Source table\nWITH source_data AS (\n    SELECT *\n    FROM dbt_test_demo.src.src_part_new\n),\n\n-- 2\ufe0f\u20e3 Current target rows\ncurrent_dim AS (\n    \n        SELECT *\n        FROM dbt_test_demo.curated.dim_part_new\n        WHERE IS_CURRENT = 'Y'\n    \n),\n\n-- 3\ufe0f\u20e3 Identify changed or new rows based on non-business keys only\ndelta AS (\n    SELECT s.*\n    FROM source_data s\n    LEFT JOIN current_dim d\n        ON s.P_PARTKEY = d.P_PARTKEY\n    WHERE d.P_PARTKEY IS NULL\n       OR s.P_NAME    <> d.P_NAME\n       OR s.P_COMMENT <> d.P_COMMENT\n),\n\n-- 4\ufe0f\u20e3 Expire old rows (those that are changing)\nexpired AS (\n    SELECT d.P_PARTKEY,\n           CURRENT_DATE AS EFFECTIVE_TO\n    FROM current_dim d\n    INNER JOIN delta s\n        ON d.P_PARTKEY = s.P_PARTKEY\n),\n\n-- 5\ufe0f\u20e3 Stage delta rows for SCD2\nstaged AS (\n    SELECT\n        P_PARTKEY,\n        P_NAME,\n        P_MFGR,\n        P_BRAND,\n        P_TYPE,\n        P_SIZE,\n        P_CONTAINER,\n        P_RETAILPRICE,\n        P_COMMENT,\n        CURRENT_DATE AS EFFECTIVE_FROM,\n        DATE('9999-12-31') AS EFFECTIVE_TO,\n        'Y' AS IS_CURRENT\n    FROM delta\n)\n\nSELECT * FROM staged", "relation_name": "dbt_test_demo.curated.dim_part_new", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-25T04:28:38.598535Z", "completed_at": "2025-12-25T04:28:38.603536Z"}, {"name": "execute", "started_at": "2025-12-25T04:28:38.605533Z", "completed_at": "2025-12-25T04:28:40.220444Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6229100227355957, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c1476c-3203-9366-0006-f3c200012ab6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.DBT_TEST_DEMO.dim_part_new_Type2", "compiled": true, "compiled_code": "SELECT \n    *,\n    -- Create a flag for easy reporting\n    CASE \n        WHEN dbt_valid_to = DATE('9999-12-31') THEN 'Y' \n        ELSE 'N' \n    END AS IS_CURRENT\nFROM DBT_TEST_DEMO.curated.src_snapshot_part_new_type2", "relation_name": "dbt_test_demo.curated.dim_part_new_Type2", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-25T04:28:40.228444Z", "completed_at": "2025-12-25T04:28:40.234531Z"}, {"name": "execute", "started_at": "2025-12-25T04:28:40.235443Z", "completed_at": "2025-12-25T04:28:41.768713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5422651767730713, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c1476c-3203-9366-0006-f3c200012ad2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.DBT_TEST_DEMO.fact_parts", "compiled": true, "compiled_code": "\n\nWITH orders AS (\n    SELECT *\n    FROM dbt_test_demo.src.src_part_new\n),\n\nfinal AS (\n    SELECT\n       *\n    FROM orders o\n    \n        -- Incremental filter: Only new/changed data\n        WHERE o.p_partkey > (\n            SELECT COALESCE(MAX(p_partkey), '0') \n            FROM dbt_test_demo.curated.fact_parts\n        )\n    \n)\n\nSELECT *\nFROM final", "relation_name": "dbt_test_demo.curated.fact_parts", "batch_results": null}], "elapsed_time": 10.952741861343384, "args": {"log_path": "C:\\Users\\Admin\\OneDrive\\Desktop\\DB2_SNOWFLAKE\\dbt-test-framework_new\\logs", "empty": false, "cache_selected_only": false, "state_modified_compare_vars": false, "partial_parse_file_diff": true, "macro_debugging": false, "log_level": "info", "require_nested_cumulative_type_params": false, "project_dir": "C:\\Users\\Admin\\OneDrive\\Desktop\\DB2_SNOWFLAKE\\dbt-test-framework_new", "strict_mode": false, "vars": {}, "profiles_dir": "./", "show_resource_report": false, "log_format_file": "debug", "quiet": false, "indirect_selection": "eager", "printer_width": 80, "require_resource_names_without_spaces": true, "invocation_command": "dbt run --profiles-dir ./ -select curated", "upload_to_artifacts_ingest_api": false, "log_level_file": "debug", "populate_cache": true, "print": true, "version_check": true, "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "write_json": true, "require_all_warnings_handled_by_warn_error": false, "require_batched_execution_for_custom_microbatch_strategy": false, "show_all_deprecations": false, "state_modified_compare_more_unrendered_values": false, "validate_macro_args": false, "require_generic_test_arguments_property": true, "select": ["elect", "curated"], "favor_state": false, "source_freshness_run_project_hooks": true, "exclude": [], "partial_parse": true, "use_colors_file": true, "use_fast_test_edges": false, "log_file_max_bytes": 10485760, "defer": false, "use_colors": true, "skip_nodes_if_on_run_start_fails": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "introspect": true, "require_yaml_configuration_for_mf_time_spines": false, "which": "run", "static_parser": true, "log_format": "default"}}